apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    banzaicloud.com/last-applied: '{"metadata":{"labels":{"app":"rook-ceph-osd","ceph-osd-id":"0","ceph-version":"16.2.6-0","ceph.rook.io/DeviceSet":"set1","ceph.rook.io/pvc":"set1-data-0582px","ceph_daemon_id":"0","ceph_daemon_type":"osd","failure-domain":"set1-data-0582px","osd":"0","portable":"true","rook-version":"v1.7.7","rook_cluster":"rook-ceph","topology-location-host":"set1-data-0582px","topology-location-region":"chinaeast2","topology-location-root":"default","topology-location-zone":"0"},"name":"rook-ceph-osd-0","namespace":"rook-ceph","ownerReferences":[{"apiVersion":"ceph.rook.io/v1","blockOwnerDeletion":true,"controller":true,"kind":"CephCluster","name":"rook-ceph","uid":"b72125b7-11ff-49b3-8d33-9c97c83b79fb"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app":"rook-ceph-osd","ceph-osd-id":"0","rook_cluster":"rook-ceph"}},"strategy":{"type":"Recreate"},"template":{"metadata":{"labels":{"app":"rook-ceph-osd","ceph-osd-id":"0","ceph-version":"16.2.6-0","ceph.rook.io/DeviceSet":"set1","ceph.rook.io/pvc":"set1-data-0582px","ceph_daemon_id":"0","ceph_daemon_type":"osd","failure-domain":"set1-data-0582px","osd":"0","portable":"true","rook-version":"v1.7.7","rook_cluster":"rook-ceph","topology-location-host":"set1-data-0582px","topology-location-region":"chinaeast2","topology-location-root":"default","topology-location-zone":"0"},"name":"rook-ceph-osd"},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"node.kubernetes.io/instance-type","operator":"In","values":["Standard_DS2_v2"]},{"key":"topology.kubernetes.io/zone","operator":"In","values":["0"]}]}]}}},"containers":[{"args":["--foreground","--id","0","--fsid","3be55f4d-1839-4997-9c7f-1678acaf1827","--setuser","ceph","--setgroup","ceph","--crush-location=root=default
      host=set1-data-0582px region=chinaeast2 zone=0","--osd-recovery-sleep=0.1","--osd-snap-trim-sleep=2","--osd-delete-sleep=2","--log-to-stderr=true","--err-to-stderr=true","--mon-cluster-log-to-stderr=true","--log-stderr-prefix=debug
      ","--default-log-to-file=false","--default-mon-cluster-log-to-file=false","--ms-learn-addr-from-peer=false"],"command":["ceph-osd"],"env":[{"name":"ROOK_NODE_NAME","value":"set1-data-0582px"},{"name":"ROOK_CLUSTER_ID","value":"b72125b7-11ff-49b3-8d33-9c97c83b79fb"},{"name":"ROOK_CLUSTER_NAME","value":"rook-ceph"},{"name":"ROOK_PRIVATE_IP","valueFrom":{"fieldRef":{"fieldPath":"status.podIP"}}},{"name":"ROOK_PUBLIC_IP","valueFrom":{"fieldRef":{"fieldPath":"status.podIP"}}},{"name":"POD_NAMESPACE","value":"rook-ceph"},{"name":"ROOK_MON_ENDPOINTS","valueFrom":{"configMapKeyRef":{"key":"data","name":"rook-ceph-mon-endpoints"}}},{"name":"ROOK_MON_SECRET","valueFrom":{"secretKeyRef":{"key":"mon-secret","name":"rook-ceph-mon"}}},{"name":"ROOK_CEPH_USERNAME","valueFrom":{"secretKeyRef":{"key":"ceph-username","name":"rook-ceph-mon"}}},{"name":"ROOK_CEPH_SECRET","valueFrom":{"secretKeyRef":{"key":"ceph-secret","name":"rook-ceph-mon"}}},{"name":"ROOK_CONFIG_DIR","value":"/var/lib/rook"},{"name":"ROOK_CEPH_CONFIG_OVERRIDE","value":"/etc/rook/config/override.conf"},{"name":"ROOK_FSID","valueFrom":{"secretKeyRef":{"key":"fsid","name":"rook-ceph-mon"}}},{"name":"NODE_NAME","valueFrom":{"fieldRef":{"fieldPath":"spec.nodeName"}}},{"name":"ROOK_CRUSHMAP_ROOT","value":"default"},{"name":"ROOK_CRUSHMAP_HOSTNAME","value":"set1-data-0582px"},{"name":"CEPH_VOLUME_DEBUG","value":"1"},{"name":"CEPH_VOLUME_SKIP_RESTORECON","value":"1"},{"name":"DM_DISABLE_UDEV","value":"1"},{"name":"TINI_SUBREAPER"},{"name":"CONTAINER_IMAGE","value":"quay.io/ceph/ceph:v16.2.6"},{"name":"POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"POD_MEMORY_LIMIT","valueFrom":{"resourceFieldRef":{"divisor":"0","resource":"limits.memory"}}},{"name":"POD_MEMORY_REQUEST","valueFrom":{"resourceFieldRef":{"divisor":"0","resource":"requests.memory"}}},{"name":"POD_CPU_LIMIT","valueFrom":{"resourceFieldRef":{"divisor":"1","resource":"limits.cpu"}}},{"name":"POD_CPU_REQUEST","valueFrom":{"resourceFieldRef":{"divisor":"0","resource":"requests.cpu"}}},{"name":"ROOK_OSD_UUID","value":"38015f74-cfcb-40b3-aae2-496abe480b06"},{"name":"ROOK_OSD_ID","value":"0"},{"name":"ROOK_CEPH_MON_HOST","valueFrom":{"secretKeyRef":{"key":"mon_host","name":"rook-ceph-config"}}},{"name":"CEPH_ARGS","value":"-m
      $(ROOK_CEPH_MON_HOST)"},{"name":"ROOK_BLOCK_PATH","value":"/mnt/set1-data-0582px"},{"name":"ROOK_CV_MODE","value":"raw"},{"name":"ROOK_OSD_DEVICE_CLASS","value":"hdd"},{"name":"ROOK_OSD_PVC_SIZE","value":"128Gi"},{"name":"ROOK_TOPOLOGY_AFFINITY","value":"topology.kubernetes.io/zone=0"},{"name":"ROOK_PVC_BACKED_OSD","value":"true"}],"image":"quay.io/ceph/ceph:v16.2.6","livenessProbe":{"exec":{"command":["env","-i","sh","-c","ceph
      --admin-daemon /run/ceph/ceph-osd.0.asok status"]},"initialDelaySeconds":45},"name":"osd","resources":{},"securityContext":{"privileged":true},"volumeMounts":[{"mountPath":"/var/lib/rook","name":"rook-data"},{"mountPath":"/etc/ceph","name":"rook-config-override","readOnly":true},{"mountPath":"/var/log/ceph","name":"rook-ceph-log"},{"mountPath":"/var/lib/ceph/crash","name":"rook-ceph-crash"},{"mountPath":"/run/udev","name":"run-udev"},{"mountPath":"/var/lib/ceph/osd/ceph-0","name":"set1-data-0582px-bridge","subPath":"ceph-0"}],"workingDir":"/var/log/ceph"}],"initContainers":[{"command":["/bin/bash","-c","\nset
      -xe\n\nPVC_SOURCE=/set1-data-0582px\nPVC_DEST=/var/lib/ceph/osd/ceph-0/block\nCP_ARGS=(--archive
      --dereference --verbose)\n\nif [ -b \"$PVC_DEST\" ]; then\n\tPVC_SOURCE_MAJ_MIN=$(stat
      --format ''%t%T'' $PVC_SOURCE)\n\tPVC_DEST_MAJ_MIN=$(stat --format ''%t%T''
      $PVC_DEST)\n\tif [[ \"$PVC_SOURCE_MAJ_MIN\" == \"$PVC_DEST_MAJ_MIN\" ]]; then\n\t\tCP_ARGS+=(--no-clobber)\n\telse\n\t\techo
      \"PVC''s source major/minor numbers changed\"\n\t\tCP_ARGS+=(--remove-destination)\n\tfi\nfi\n\ncp
      \"${CP_ARGS[@]}\" \"$PVC_SOURCE\" \"$PVC_DEST\"\n"],"image":"quay.io/ceph/ceph:v16.2.6","name":"blkdevmapper","resources":{},"volumeDevices":[{"devicePath":"/set1-data-0582px","name":"set1-data-0582px"}],"volumeMounts":[{"mountPath":"/var/lib/ceph/osd/ceph-0","name":"set1-data-0582px-bridge","subPath":"ceph-0"}]},{"args":["prime-osd-dir","--dev","/var/lib/ceph/osd/ceph-0/block","--path","/var/lib/ceph/osd/ceph-0","--no-mon-config"],"command":["ceph-bluestore-tool"],"image":"quay.io/ceph/ceph:v16.2.6","name":"activate","resources":{},"securityContext":{"privileged":true},"volumeDevices":[{"devicePath":"/var/lib/ceph/osd/ceph-0/block","name":"set1-data-0582px"}],"volumeMounts":[{"mountPath":"/var/lib/ceph/osd/ceph-0","name":"set1-data-0582px-bridge","subPath":"ceph-0"}]},{"args":["bluefs-bdev-expand","--path","/var/lib/ceph/osd/ceph-0"],"command":["ceph-bluestore-tool"],"image":"quay.io/ceph/ceph:v16.2.6","name":"expand-bluefs","resources":{},"securityContext":{"privileged":true},"volumeMounts":[{"mountPath":"/var/lib/ceph/osd/ceph-0","name":"set1-data-0582px-bridge","subPath":"ceph-0"}]},{"args":["--verbose","--recursive","ceph:ceph","/var/log/ceph","/var/lib/ceph/crash","/var/lib/ceph/osd/ceph-0"],"command":["chown"],"image":"quay.io/ceph/ceph:v16.2.6","name":"chown-container-data-dir","resources":{},"securityContext":{"privileged":true},"volumeMounts":[{"mountPath":"/var/lib/rook","name":"rook-data"},{"mountPath":"/etc/ceph","name":"rook-config-override","readOnly":true},{"mountPath":"/var/log/ceph","name":"rook-ceph-log"},{"mountPath":"/var/lib/ceph/crash","name":"rook-ceph-crash"},{"mountPath":"/run/udev","name":"run-udev"},{"mountPath":"/var/lib/ceph/osd/ceph-0","name":"set1-data-0582px-bridge","subPath":"ceph-0"}]}],"restartPolicy":"Always","serviceAccountName":"rook-ceph-osd","tolerations":[{"effect":"NoExecute","key":"node.kubernetes.io/unreachable","operator":"Exists","tolerationSeconds":5}],"topologySpreadConstraints":[{"labelSelector":{"matchExpressions":[{"key":"app","operator":"In","values":["rook-ceph-osd"]}]},"maxSkew":1,"topologyKey":"kubernetes.io/hostname","whenUnsatisfiable":"ScheduleAnyway"}],"volumes":[{"emptyDir":{},"name":"rook-data"},{"name":"rook-config-override","projected":{"sources":[{"configMap":{"items":[{"key":"config","mode":292,"path":"ceph.conf"}],"name":"rook-config-override"}}]}},{"hostPath":{"path":"/var/lib/rook/rook-ceph/log"},"name":"rook-ceph-log"},{"hostPath":{"path":"/var/lib/rook/rook-ceph/crash"},"name":"rook-ceph-crash"},{"name":"set1-data-0582px","persistentVolumeClaim":{"claimName":"set1-data-0582px"}},{"hostPath":{"path":"/var/lib/rook/rook-ceph/set1-data-0582px","type":"DirectoryOrCreate"},"name":"set1-data-0582px-bridge"},{"hostPath":{"path":"/run/udev"},"name":"run-udev"}]}}},"status":{}}'
    deployment.kubernetes.io/revision: "1"
  creationTimestamp: "2021-11-29T09:08:33Z"
  generation: 1
  labels:
    app: rook-ceph-osd
    ceph-osd-id: "0"
    ceph-version: 16.2.6-0
    ceph.rook.io/DeviceSet: set1
    ceph.rook.io/pvc: set1-data-0582px
    ceph_daemon_id: "0"
    ceph_daemon_type: osd
    failure-domain: set1-data-0582px
    osd: "0"
    portable: "true"
    rook-version: v1.7.7
    rook_cluster: rook-ceph
    topology-location-host: set1-data-0582px
    topology-location-region: chinaeast2
    topology-location-root: default
    topology-location-zone: "0"
  managedFields:
  - apiVersion: apps/v1
    fieldsType: FieldsV1
    fieldsV1:
      f:metadata:
        f:annotations:
          .: {}
          f:banzaicloud.com/last-applied: {}
        f:labels:
          .: {}
          f:app: {}
          f:ceph-osd-id: {}
          f:ceph-version: {}
          f:ceph.rook.io/DeviceSet: {}
          f:ceph.rook.io/pvc: {}
          f:ceph_daemon_id: {}
          f:ceph_daemon_type: {}
          f:failure-domain: {}
          f:osd: {}
          f:portable: {}
          f:rook-version: {}
          f:rook_cluster: {}
          f:topology-location-host: {}
          f:topology-location-region: {}
          f:topology-location-root: {}
          f:topology-location-zone: {}
        f:ownerReferences:
          .: {}
          k:{"uid":"b72125b7-11ff-49b3-8d33-9c97c83b79fb"}:
            .: {}
            f:apiVersion: {}
            f:blockOwnerDeletion: {}
            f:controller: {}
            f:kind: {}
            f:name: {}
            f:uid: {}
      f:spec:
        f:progressDeadlineSeconds: {}
        f:replicas: {}
        f:revisionHistoryLimit: {}
        f:selector: {}
        f:strategy:
          f:type: {}
        f:template:
          f:metadata:
            f:labels:
              .: {}
              f:app: {}
              f:ceph-osd-id: {}
              f:ceph-version: {}
              f:ceph.rook.io/DeviceSet: {}
              f:ceph.rook.io/pvc: {}
              f:ceph_daemon_id: {}
              f:ceph_daemon_type: {}
              f:failure-domain: {}
              f:osd: {}
              f:portable: {}
              f:rook-version: {}
              f:rook_cluster: {}
              f:topology-location-host: {}
              f:topology-location-region: {}
              f:topology-location-root: {}
              f:topology-location-zone: {}
            f:name: {}
          f:spec:
            f:affinity:
              .: {}
              f:nodeAffinity:
                .: {}
                f:requiredDuringSchedulingIgnoredDuringExecution:
                  .: {}
                  f:nodeSelectorTerms: {}
            f:containers:
              k:{"name":"osd"}:
                .: {}
                f:args: {}
                f:command: {}
                f:env:
                  .: {}
                  k:{"name":"CEPH_ARGS"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"CEPH_VOLUME_DEBUG"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"CEPH_VOLUME_SKIP_RESTORECON"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"CONTAINER_IMAGE"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"DM_DISABLE_UDEV"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"NODE_NAME"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:fieldRef:
                        .: {}
                        f:apiVersion: {}
                        f:fieldPath: {}
                  k:{"name":"POD_CPU_LIMIT"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:resourceFieldRef:
                        .: {}
                        f:divisor: {}
                        f:resource: {}
                  k:{"name":"POD_CPU_REQUEST"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:resourceFieldRef:
                        .: {}
                        f:divisor: {}
                        f:resource: {}
                  k:{"name":"POD_MEMORY_LIMIT"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:resourceFieldRef:
                        .: {}
                        f:divisor: {}
                        f:resource: {}
                  k:{"name":"POD_MEMORY_REQUEST"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:resourceFieldRef:
                        .: {}
                        f:divisor: {}
                        f:resource: {}
                  k:{"name":"POD_NAME"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:fieldRef:
                        .: {}
                        f:apiVersion: {}
                        f:fieldPath: {}
                  k:{"name":"POD_NAMESPACE"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_BLOCK_PATH"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CEPH_CONFIG_OVERRIDE"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CEPH_MON_HOST"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:secretKeyRef:
                        .: {}
                        f:key: {}
                        f:name: {}
                  k:{"name":"ROOK_CEPH_SECRET"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:secretKeyRef:
                        .: {}
                        f:key: {}
                        f:name: {}
                  k:{"name":"ROOK_CEPH_USERNAME"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:secretKeyRef:
                        .: {}
                        f:key: {}
                        f:name: {}
                  k:{"name":"ROOK_CLUSTER_ID"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CLUSTER_NAME"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CONFIG_DIR"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CRUSHMAP_HOSTNAME"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CRUSHMAP_ROOT"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_CV_MODE"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_FSID"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:secretKeyRef:
                        .: {}
                        f:key: {}
                        f:name: {}
                  k:{"name":"ROOK_MON_ENDPOINTS"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:configMapKeyRef:
                        .: {}
                        f:key: {}
                        f:name: {}
                  k:{"name":"ROOK_MON_SECRET"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:secretKeyRef:
                        .: {}
                        f:key: {}
                        f:name: {}
                  k:{"name":"ROOK_NODE_NAME"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_OSD_DEVICE_CLASS"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_OSD_ID"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_OSD_PVC_SIZE"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_OSD_UUID"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_PRIVATE_IP"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:fieldRef:
                        .: {}
                        f:apiVersion: {}
                        f:fieldPath: {}
                  k:{"name":"ROOK_PUBLIC_IP"}:
                    .: {}
                    f:name: {}
                    f:valueFrom:
                      .: {}
                      f:fieldRef:
                        .: {}
                        f:apiVersion: {}
                        f:fieldPath: {}
                  k:{"name":"ROOK_PVC_BACKED_OSD"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"ROOK_TOPOLOGY_AFFINITY"}:
                    .: {}
                    f:name: {}
                    f:value: {}
                  k:{"name":"TINI_SUBREAPER"}:
                    .: {}
                    f:name: {}
                f:image: {}
                f:imagePullPolicy: {}
                f:livenessProbe:
                  .: {}
                  f:exec:
                    .: {}
                    f:command: {}
                  f:failureThreshold: {}
                  f:initialDelaySeconds: {}
                  f:periodSeconds: {}
                  f:successThreshold: {}
                  f:timeoutSeconds: {}
                f:name: {}
                f:resources: {}
                f:securityContext:
                  .: {}
                  f:privileged: {}
                  f:readOnlyRootFilesystem: {}
                  f:runAsUser: {}
                f:terminationMessagePath: {}
                f:terminationMessagePolicy: {}
                f:volumeMounts:
                  .: {}
                  k:{"mountPath":"/etc/ceph"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:readOnly: {}
                  k:{"mountPath":"/run/udev"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/var/lib/ceph/crash"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/var/lib/ceph/osd/ceph-0"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:subPath: {}
                  k:{"mountPath":"/var/lib/rook"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/var/log/ceph"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                f:workingDir: {}
            f:dnsPolicy: {}
            f:initContainers:
              .: {}
              k:{"name":"activate"}:
                .: {}
                f:args: {}
                f:command: {}
                f:image: {}
                f:imagePullPolicy: {}
                f:name: {}
                f:resources: {}
                f:securityContext:
                  .: {}
                  f:privileged: {}
                f:terminationMessagePath: {}
                f:terminationMessagePolicy: {}
                f:volumeDevices:
                  .: {}
                  k:{"devicePath":"/var/lib/ceph/osd/ceph-0/block"}:
                    .: {}
                    f:devicePath: {}
                    f:name: {}
                f:volumeMounts:
                  .: {}
                  k:{"mountPath":"/var/lib/ceph/osd/ceph-0"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:subPath: {}
              k:{"name":"blkdevmapper"}:
                .: {}
                f:command: {}
                f:image: {}
                f:imagePullPolicy: {}
                f:name: {}
                f:resources: {}
                f:securityContext:
                  .: {}
                  f:privileged: {}
                f:terminationMessagePath: {}
                f:terminationMessagePolicy: {}
                f:volumeDevices:
                  .: {}
                  k:{"devicePath":"/set1-data-0582px"}:
                    .: {}
                    f:devicePath: {}
                    f:name: {}
                f:volumeMounts:
                  .: {}
                  k:{"mountPath":"/var/lib/ceph/osd/ceph-0"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:subPath: {}
              k:{"name":"chown-container-data-dir"}:
                .: {}
                f:args: {}
                f:command: {}
                f:image: {}
                f:imagePullPolicy: {}
                f:name: {}
                f:resources: {}
                f:securityContext:
                  .: {}
                  f:privileged: {}
                  f:readOnlyRootFilesystem: {}
                  f:runAsUser: {}
                f:terminationMessagePath: {}
                f:terminationMessagePolicy: {}
                f:volumeMounts:
                  .: {}
                  k:{"mountPath":"/etc/ceph"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:readOnly: {}
                  k:{"mountPath":"/run/udev"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/var/lib/ceph/crash"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/var/lib/ceph/osd/ceph-0"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:subPath: {}
                  k:{"mountPath":"/var/lib/rook"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                  k:{"mountPath":"/var/log/ceph"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
              k:{"name":"expand-bluefs"}:
                .: {}
                f:args: {}
                f:command: {}
                f:image: {}
                f:imagePullPolicy: {}
                f:name: {}
                f:resources: {}
                f:securityContext:
                  .: {}
                  f:privileged: {}
                f:terminationMessagePath: {}
                f:terminationMessagePolicy: {}
                f:volumeMounts:
                  .: {}
                  k:{"mountPath":"/var/lib/ceph/osd/ceph-0"}:
                    .: {}
                    f:mountPath: {}
                    f:name: {}
                    f:subPath: {}
            f:restartPolicy: {}
            f:schedulerName: {}
            f:securityContext: {}
            f:serviceAccount: {}
            f:serviceAccountName: {}
            f:terminationGracePeriodSeconds: {}
            f:tolerations: {}
            f:topologySpreadConstraints:
              .: {}
              k:{"topologyKey":"kubernetes.io/hostname","whenUnsatisfiable":"ScheduleAnyway"}:
                .: {}
                f:labelSelector: {}
                f:maxSkew: {}
                f:topologyKey: {}
                f:whenUnsatisfiable: {}
            f:volumes:
              .: {}
              k:{"name":"rook-ceph-crash"}:
                .: {}
                f:hostPath:
                  .: {}
                  f:path: {}
                  f:type: {}
                f:name: {}
              k:{"name":"rook-ceph-log"}:
                .: {}
                f:hostPath:
                  .: {}
                  f:path: {}
                  f:type: {}
                f:name: {}
              k:{"name":"rook-config-override"}:
                .: {}
                f:name: {}
                f:projected:
                  .: {}
                  f:defaultMode: {}
                  f:sources: {}
              k:{"name":"rook-data"}:
                .: {}
                f:emptyDir: {}
                f:name: {}
              k:{"name":"run-udev"}:
                .: {}
                f:hostPath:
                  .: {}
                  f:path: {}
                  f:type: {}
                f:name: {}
              k:{"name":"set1-data-0582px"}:
                .: {}
                f:name: {}
                f:persistentVolumeClaim:
                  .: {}
                  f:claimName: {}
              k:{"name":"set1-data-0582px-bridge"}:
                .: {}
                f:hostPath:
                  .: {}
                  f:path: {}
                  f:type: {}
                f:name: {}
    manager: rook
    operation: Update
    time: "2021-11-29T09:08:33Z"
  - apiVersion: apps/v1
    fieldsType: FieldsV1
    fieldsV1:
      f:metadata:
        f:annotations:
          f:deployment.kubernetes.io/revision: {}
      f:status:
        f:availableReplicas: {}
        f:conditions:
          .: {}
          k:{"type":"Available"}:
            .: {}
            f:lastTransitionTime: {}
            f:lastUpdateTime: {}
            f:message: {}
            f:reason: {}
            f:status: {}
            f:type: {}
          k:{"type":"Progressing"}:
            .: {}
            f:lastTransitionTime: {}
            f:lastUpdateTime: {}
            f:message: {}
            f:reason: {}
            f:status: {}
            f:type: {}
        f:observedGeneration: {}
        f:readyReplicas: {}
        f:replicas: {}
        f:updatedReplicas: {}
    manager: kube-controller-manager
    operation: Update
    time: "2021-11-29T09:08:41Z"
  name: rook-ceph-osd-0
  namespace: rook-ceph
  ownerReferences:
  - apiVersion: ceph.rook.io/v1
    blockOwnerDeletion: true
    controller: true
    kind: CephCluster
    name: rook-ceph
    uid: b72125b7-11ff-49b3-8d33-9c97c83b79fb
  resourceVersion: "3100"
  uid: 9fc4b132-a7f8-4bb0-a2de-65138eeb4e5b
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: rook-ceph-osd
      ceph-osd-id: "0"
      rook_cluster: rook-ceph
  strategy:
    type: Recreate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: rook-ceph-osd
        ceph-osd-id: "0"
        ceph-version: 16.2.6-0
        ceph.rook.io/DeviceSet: set1
        ceph.rook.io/pvc: set1-data-0582px
        ceph_daemon_id: "0"
        ceph_daemon_type: osd
        failure-domain: set1-data-0582px
        osd: "0"
        portable: "true"
        rook-version: v1.7.7
        rook_cluster: rook-ceph
        topology-location-host: set1-data-0582px
        topology-location-region: chinaeast2
        topology-location-root: default
        topology-location-zone: "0"
      name: rook-ceph-osd
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: node.kubernetes.io/instance-type
                operator: In
                values:
                - Standard_DS2_v2
              - key: topology.kubernetes.io/zone
                operator: In
                values:
                - "0"
      containers:
      - args:
        - --foreground
        - --id
        - "0"
        - --fsid
        - 3be55f4d-1839-4997-9c7f-1678acaf1827
        - --setuser
        - ceph
        - --setgroup
        - ceph
        - --crush-location=root=default host=set1-data-0582px region=chinaeast2 zone=0
        - --osd-recovery-sleep=0.1
        - --osd-snap-trim-sleep=2
        - --osd-delete-sleep=2
        - --log-to-stderr=true
        - --err-to-stderr=true
        - --mon-cluster-log-to-stderr=true
        - '--log-stderr-prefix=debug '
        - --default-log-to-file=false
        - --default-mon-cluster-log-to-file=false
        - --ms-learn-addr-from-peer=false
        command:
        - ceph-osd
        env:
        - name: ROOK_NODE_NAME
          value: set1-data-0582px
        - name: ROOK_CLUSTER_ID
          value: b72125b7-11ff-49b3-8d33-9c97c83b79fb
        - name: ROOK_CLUSTER_NAME
          value: rook-ceph
        - name: ROOK_PRIVATE_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.podIP
        - name: ROOK_PUBLIC_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.podIP
        - name: POD_NAMESPACE
          value: rook-ceph
        - name: ROOK_MON_ENDPOINTS
          valueFrom:
            configMapKeyRef:
              key: data
              name: rook-ceph-mon-endpoints
        - name: ROOK_MON_SECRET
          valueFrom:
            secretKeyRef:
              key: mon-secret
              name: rook-ceph-mon
        - name: ROOK_CEPH_USERNAME
          valueFrom:
            secretKeyRef:
              key: ceph-username
              name: rook-ceph-mon
        - name: ROOK_CEPH_SECRET
          valueFrom:
            secretKeyRef:
              key: ceph-secret
              name: rook-ceph-mon
        - name: ROOK_CONFIG_DIR
          value: /var/lib/rook
        - name: ROOK_CEPH_CONFIG_OVERRIDE
          value: /etc/rook/config/override.conf
        - name: ROOK_FSID
          valueFrom:
            secretKeyRef:
              key: fsid
              name: rook-ceph-mon
        - name: NODE_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: spec.nodeName
        - name: ROOK_CRUSHMAP_ROOT
          value: default
        - name: ROOK_CRUSHMAP_HOSTNAME
          value: set1-data-0582px
        - name: CEPH_VOLUME_DEBUG
          value: "1"
        - name: CEPH_VOLUME_SKIP_RESTORECON
          value: "1"
        - name: DM_DISABLE_UDEV
          value: "1"
        - name: TINI_SUBREAPER
        - name: CONTAINER_IMAGE
          value: quay.io/ceph/ceph:v16.2.6
        - name: POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: POD_MEMORY_LIMIT
          valueFrom:
            resourceFieldRef:
              divisor: "0"
              resource: limits.memory
        - name: POD_MEMORY_REQUEST
          valueFrom:
            resourceFieldRef:
              divisor: "0"
              resource: requests.memory
        - name: POD_CPU_LIMIT
          valueFrom:
            resourceFieldRef:
              divisor: "1"
              resource: limits.cpu
        - name: POD_CPU_REQUEST
          valueFrom:
            resourceFieldRef:
              divisor: "0"
              resource: requests.cpu
        - name: ROOK_OSD_UUID
          value: 38015f74-cfcb-40b3-aae2-496abe480b06
        - name: ROOK_OSD_ID
          value: "0"
        - name: ROOK_CEPH_MON_HOST
          valueFrom:
            secretKeyRef:
              key: mon_host
              name: rook-ceph-config
        - name: CEPH_ARGS
          value: -m $(ROOK_CEPH_MON_HOST)
        - name: ROOK_BLOCK_PATH
          value: /mnt/set1-data-0582px
        - name: ROOK_CV_MODE
          value: raw
        - name: ROOK_OSD_DEVICE_CLASS
          value: hdd
        - name: ROOK_OSD_PVC_SIZE
          value: 128Gi
        - name: ROOK_TOPOLOGY_AFFINITY
          value: topology.kubernetes.io/zone=0
        - name: ROOK_PVC_BACKED_OSD
          value: "true"
        image: quay.io/ceph/ceph:v16.2.6
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - env
            - -i
            - sh
            - -c
            - ceph --admin-daemon /run/ceph/ceph-osd.0.asok status
          failureThreshold: 3
          initialDelaySeconds: 45
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        name: osd
        resources: {}
        securityContext:
          privileged: true
          readOnlyRootFilesystem: false
          runAsUser: 0
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /var/lib/rook
          name: rook-data
        - mountPath: /etc/ceph
          name: rook-config-override
          readOnly: true
        - mountPath: /var/log/ceph
          name: rook-ceph-log
        - mountPath: /var/lib/ceph/crash
          name: rook-ceph-crash
        - mountPath: /run/udev
          name: run-udev
        - mountPath: /var/lib/ceph/osd/ceph-0
          name: set1-data-0582px-bridge
          subPath: ceph-0
        workingDir: /var/log/ceph
      dnsPolicy: ClusterFirst
      initContainers:
      - command:
        - /bin/bash
        - -c
        - "\nset -xe\n\nPVC_SOURCE=/set1-data-0582px\nPVC_DEST=/var/lib/ceph/osd/ceph-0/block\nCP_ARGS=(--archive
          --dereference --verbose)\n\nif [ -b \"$PVC_DEST\" ]; then\n\tPVC_SOURCE_MAJ_MIN=$(stat
          --format '%t%T' $PVC_SOURCE)\n\tPVC_DEST_MAJ_MIN=$(stat --format '%t%T'
          $PVC_DEST)\n\tif [[ \"$PVC_SOURCE_MAJ_MIN\" == \"$PVC_DEST_MAJ_MIN\" ]];
          then\n\t\tCP_ARGS+=(--no-clobber)\n\telse\n\t\techo \"PVC's source major/minor
          numbers changed\"\n\t\tCP_ARGS+=(--remove-destination)\n\tfi\nfi\n\ncp \"${CP_ARGS[@]}\"
          \"$PVC_SOURCE\" \"$PVC_DEST\"\n"
        image: quay.io/ceph/ceph:v16.2.6
        imagePullPolicy: IfNotPresent
        name: blkdevmapper
        resources: {}
        securityContext:
          privileged: false
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeDevices:
        - devicePath: /set1-data-0582px
          name: set1-data-0582px
        volumeMounts:
        - mountPath: /var/lib/ceph/osd/ceph-0
          name: set1-data-0582px-bridge
          subPath: ceph-0
      - args:
        - prime-osd-dir
        - --dev
        - /var/lib/ceph/osd/ceph-0/block
        - --path
        - /var/lib/ceph/osd/ceph-0
        - --no-mon-config
        command:
        - ceph-bluestore-tool
        image: quay.io/ceph/ceph:v16.2.6
        imagePullPolicy: IfNotPresent
        name: activate
        resources: {}
        securityContext:
          privileged: true
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeDevices:
        - devicePath: /var/lib/ceph/osd/ceph-0/block
          name: set1-data-0582px
        volumeMounts:
        - mountPath: /var/lib/ceph/osd/ceph-0
          name: set1-data-0582px-bridge
          subPath: ceph-0
      - args:
        - bluefs-bdev-expand
        - --path
        - /var/lib/ceph/osd/ceph-0
        command:
        - ceph-bluestore-tool
        image: quay.io/ceph/ceph:v16.2.6
        imagePullPolicy: IfNotPresent
        name: expand-bluefs
        resources: {}
        securityContext:
          privileged: true
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /var/lib/ceph/osd/ceph-0
          name: set1-data-0582px-bridge
          subPath: ceph-0
      - args:
        - --verbose
        - --recursive
        - ceph:ceph
        - /var/log/ceph
        - /var/lib/ceph/crash
        - /var/lib/ceph/osd/ceph-0
        command:
        - chown
        image: quay.io/ceph/ceph:v16.2.6
        imagePullPolicy: IfNotPresent
        name: chown-container-data-dir
        resources: {}
        securityContext:
          privileged: true
          readOnlyRootFilesystem: false
          runAsUser: 0
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /var/lib/rook
          name: rook-data
        - mountPath: /etc/ceph
          name: rook-config-override
          readOnly: true
        - mountPath: /var/log/ceph
          name: rook-ceph-log
        - mountPath: /var/lib/ceph/crash
          name: rook-ceph-crash
        - mountPath: /run/udev
          name: run-udev
        - mountPath: /var/lib/ceph/osd/ceph-0
          name: set1-data-0582px-bridge
          subPath: ceph-0
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      serviceAccount: rook-ceph-osd
      serviceAccountName: rook-ceph-osd
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoExecute
        key: node.kubernetes.io/unreachable
        operator: Exists
        tolerationSeconds: 5
      topologySpreadConstraints:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values:
            - rook-ceph-osd
        maxSkew: 1
        topologyKey: kubernetes.io/hostname
        whenUnsatisfiable: ScheduleAnyway
      volumes:
      - emptyDir: {}
        name: rook-data
      - name: rook-config-override
        projected:
          defaultMode: 420
          sources:
          - configMap:
              items:
              - key: config
                mode: 292
                path: ceph.conf
              name: rook-config-override
      - hostPath:
          path: /var/lib/rook/rook-ceph/log
          type: ""
        name: rook-ceph-log
      - hostPath:
          path: /var/lib/rook/rook-ceph/crash
          type: ""
        name: rook-ceph-crash
      - name: set1-data-0582px
        persistentVolumeClaim:
          claimName: set1-data-0582px
      - hostPath:
          path: /var/lib/rook/rook-ceph/set1-data-0582px
          type: DirectoryOrCreate
        name: set1-data-0582px-bridge
      - hostPath:
          path: /run/udev
          type: ""
        name: run-udev
status:
  availableReplicas: 1
  conditions:
  - lastTransitionTime: "2021-11-29T09:08:41Z"
    lastUpdateTime: "2021-11-29T09:08:41Z"
    message: Deployment has minimum availability.
    reason: MinimumReplicasAvailable
    status: "True"
    type: Available
  - lastTransitionTime: "2021-11-29T09:08:33Z"
    lastUpdateTime: "2021-11-29T09:08:41Z"
    message: ReplicaSet "rook-ceph-osd-0-5bfb84f8fc" has successfully progressed.
    reason: NewReplicaSetAvailable
    status: "True"
    type: Progressing
  observedGeneration: 1
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1
